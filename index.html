<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ObelixIA - CRM Bancario Inteligente</title>
    <meta name="description" content="ObelixIA: Plataforma CRM bancaria con inteligencia artificial para gestión comercial, análisis financiero y cumplimiento normativo." />
    <meta name="author" content="ObelixIA" />
    <meta name="keywords" content="CRM bancario, inteligencia artificial, gestión comercial, análisis financiero, banca, fintech" />
    
    <!-- OWASP Security Headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <meta http-equiv="X-Frame-Options" content="DENY" />
    <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin" />
    <meta http-equiv="Permissions-Policy" content="geolocation=(self), camera=(self), microphone=()" />
    
    <!-- Content Security Policy (CSP) - OWASP Top 10 2024 & PSD3 Compliance -->
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      script-src 'self' 'unsafe-inline' 'unsafe-eval' https://apis.google.com https://plausible.io https://api.mapbox.com https://cdn.gpteng.co;
      style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://api.mapbox.com;
      font-src 'self' https://fonts.gstatic.com data:;
      img-src 'self' data: blob: https: http:;
      connect-src 'self' https://*.supabase.co wss://*.supabase.co https://api.ipify.org https://nominatim.openstreetmap.org https://api.maptiler.com https://api.mapbox.com https://*.mapbox.com https://fonts.googleapis.com https://fonts.gstatic.com https://plausible.io https://cdn.gpteng.co;
      worker-src 'self' blob:;
      frame-src 'self';
      object-src 'none';
      base-uri 'self';
      form-action 'self';
      frame-ancestors 'none';
      upgrade-insecure-requests;
    " />
    
    <!-- Mapbox GL CSS -->
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.css" rel="stylesheet" />
    
    <!-- DNS Prefetch for external resources -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="dns-prefetch" href="https://avaugfnqvvqcilhiudlf.supabase.co">
    
    <!-- Preconnect for critical origins with HTTP/3 support -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://avaugfnqvvqcilhiudlf.supabase.co" crossorigin>
    
    <!-- HTTP/3 Early Hints (Priority 6) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" fetchpriority="high">
    <link rel="preconnect" href="https://avaugfnqvvqcilhiudlf.supabase.co" fetchpriority="high">
    
    <!-- Speculation Rules for Prefetch (Priority 4) -->
    <script type="speculationrules">
    {
      "prefetch": [
        {
          "source": "document",
          "where": {
            "and": [
              {"href_matches": "/*"},
              {"not": {"href_matches": "/api/*"}},
              {"not": {"href_matches": "*.pdf"}}
            ]
          },
          "eagerness": "moderate"
        }
      ],
      "prerender": [
        {
          "source": "document",
          "where": {
            "selector_matches": "nav a, [role='navigation'] a"
          },
          "eagerness": "conservative"
        }
      ]
    }
    </script>
    
    <!-- Critical CSS inline for FCP -->
    <style>
      /* Critical CSS for initial render - prevents CLS */
      html { scroll-behavior: smooth; }
      body { 
        margin: 0; 
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        background-color: #0f172a;
        color: #f1f5f9;
      }
      .theme-day body { background-color: #f8fafc; color: #0f172a; }
      .theme-night body { background-color: #0f172a; color: #f1f5f9; }
      .theme-creand body { background-color: #fff; color: #222; }
      .theme-aurora body { background-color: #f5f3ff; color: #1a1040; }
      #root { min-height: 100vh; }
      
      /* Hollywood Cinematic Loader */
      .initial-loader {
        position: fixed;
        inset: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: radial-gradient(ellipse at center, #0c1929 0%, #050d18 50%, #000 100%);
        z-index: 9999;
        transition: opacity 0.8s ease;
        overflow: hidden;
      }
      .initial-loader.hidden { opacity: 0; pointer-events: none; }
      
      /* Hollywood Rainbow Arc - Blue to Green gradient */
      .hollywood-arc {
        position: absolute;
        top: 42%;
        left: 28%;
        width: 500px;
        height: 250px;
        transform: translate(-50%, -50%);
        opacity: 0;
        animation: arcReveal 3s ease-out 0.5s forwards;
      }
      .hollywood-arc::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: 250px 250px 0 0;
        background: conic-gradient(from 180deg at 50% 100%, 
          transparent 0deg, 
          #0ea5e9 30deg, 
          #06b6d4 60deg, 
          #10b981 90deg, 
          #34d399 120deg, 
          #10b981 150deg,
          #06b6d4 180deg,
          transparent 180deg);
        mask: radial-gradient(ellipse 230px 115px at 50% 100%, transparent 95%, black 100%);
        -webkit-mask: radial-gradient(ellipse 230px 115px at 50% 100%, transparent 95%, black 100%);
        filter: blur(8px);
        animation: arcGlow 4s ease-in-out infinite;
      }
      .hollywood-arc::after {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: 250px 250px 0 0;
        background: conic-gradient(from 180deg at 50% 100%, 
          transparent 0deg, 
          rgba(14,165,233,0.6) 30deg, 
          rgba(6,182,212,0.8) 60deg, 
          rgba(16,185,129,0.9) 90deg, 
          rgba(52,211,153,0.8) 120deg, 
          rgba(16,185,129,0.6) 150deg,
          rgba(6,182,212,0.4) 180deg,
          transparent 180deg);
        mask: radial-gradient(ellipse 210px 105px at 50% 100%, transparent 95%, black 100%);
        -webkit-mask: radial-gradient(ellipse 210px 105px at 50% 100%, transparent 95%, black 100%);
        filter: blur(2px);
      }
      @keyframes arcReveal {
        0% { opacity: 0; transform: translate(-50%, -50%) scale(0.3); }
        60% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
        100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
      }
      @keyframes arcGlow {
        0%, 100% { filter: blur(8px) brightness(1); }
        50% { filter: blur(12px) brightness(1.3); }
      }
      
      /* Explosion particles container */
      .explosion-particles {
        position: absolute;
        inset: 0;
        pointer-events: none;
        overflow: hidden;
      }
      .explosion-particle {
        position: absolute;
        top: 50%;
        left: 50%;
        border-radius: 50%;
        background: white;
        box-shadow: 0 0 10px currentColor, 0 0 20px currentColor;
        opacity: 0;
      }
      
      /* Ambient stars */
      .star-field {
        position: absolute;
        inset: 0;
        overflow: hidden;
      }
      .star {
        position: absolute;
        background: white;
        border-radius: 50%;
        animation: starTwinkle 3s ease-in-out infinite;
      }
      @keyframes starTwinkle {
        0%, 100% { opacity: 0.2; transform: scale(1); }
        50% { opacity: 1; transform: scale(1.5); }
      }
      
      /* Cinematic Rolling Infinity Symbol */
      .infinity-container {
        position: absolute;
        z-index: 20;
        animation: infinityJourney 5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
      }
      @keyframes infinityJourney {
        0% {
          top: 5%;
          left: 5%;
          transform: scale(0.08) rotate(0deg);
          opacity: 0;
        }
        5% {
          opacity: 1;
        }
        15% {
          top: 15%;
          left: 35%;
          transform: scale(0.15) rotate(360deg);
        }
        25% {
          top: 25%;
          left: 65%;
          transform: scale(0.25) rotate(720deg);
        }
        35% {
          top: 20%;
          left: 85%;
          transform: scale(0.35) rotate(1080deg);
        }
        45% {
          top: 70%;
          left: 80%;
          transform: scale(0.45) rotate(1440deg);
        }
        55% {
          top: 80%;
          left: 50%;
          transform: scale(0.55) rotate(1800deg);
        }
        65% {
          top: 75%;
          left: 20%;
          transform: scale(0.65) rotate(2160deg);
        }
        75% {
          top: 55%;
          left: 10%;
          transform: scale(0.8) rotate(2520deg);
        }
        85% {
          top: 62%;
          left: 50%;
          transform: scale(0.95) rotate(2880deg) translateX(-50%);
        }
        100% {
          top: 58%;
          left: 50%;
          transform: scale(1) rotate(2880deg) translateX(-50%);
          opacity: 1;
        }
      }
      
      .infinity-glow-outer {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 500px;
        height: 250px;
        transform: translate(-50%, -50%);
        background: radial-gradient(ellipse, rgba(6,182,212,0.5) 0%, rgba(16,185,129,0.3) 40%, transparent 70%);
        filter: blur(50px);
        opacity: 0;
        animation: glowAppear 5s ease-out forwards;
      }
      @keyframes glowAppear {
        0%, 80% { opacity: 0; }
        100% { opacity: 1; }
      }
      @keyframes outerGlowPulse {
        0%, 100% { transform: translate(-50%, -50%) scale(1); filter: blur(50px) brightness(1); }
        50% { transform: translate(-50%, -50%) scale(1.3); filter: blur(60px) brightness(1.3); }
      }
      
      .infinity-svg {
        width: 350px;
        height: 175px;
        filter: drop-shadow(0 0 40px rgba(6,182,212,0.9)) drop-shadow(0 0 80px rgba(16,185,129,0.6));
      }

      /* Particles: pulse + glow (JS moves them along the path) */
      .infinity-particle {
        transform-box: fill-box;
        transform-origin: center;
        animation: infinityParticlePulse 0.85s ease-in-out infinite;
      }
      @keyframes infinityParticlePulse {
        0%, 100% { opacity: 0.65; transform: scale(0.85); }
        50% { opacity: 1; transform: scale(1.2); }
      }
      
      /* Brand text - positioned in center */
      .brand-container {
        position: absolute;
        top: 38%;
        left: 50%;
        transform: translateX(-50%);
        z-index: 15;
        opacity: 0;
        animation: brandAppear 1.5s ease-out 1s forwards;
      }
      @keyframes brandAppear {
        0% { opacity: 0; transform: translateX(-50%) scale(0.8); }
        100% { opacity: 1; transform: translateX(-50%) scale(1); }
      }
      
      /* Dual Gradient Brand Typography */
      .loader-brand {
        font-family: 'Crimson Pro', Georgia, serif;
        font-size: clamp(64px, 16vw, 140px);
        font-weight: 900;
        letter-spacing: -0.02em;
        background: linear-gradient(90deg, 
          #0ea5e9 0%, 
          #06b6d4 15%, 
          #10b981 35%, 
          #34d399 50%, 
          #10b981 65%, 
          #06b6d4 85%, 
          #0ea5e9 100%);
        background-size: 200% 100%;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        animation: brandGradientFlow 6s ease infinite;
        position: relative;
        text-shadow: 0 0 100px rgba(6,182,212,0.6);
      }
      .loader-brand::before {
        content: 'ObelixIA';
        position: absolute;
        inset: 0;
        background: linear-gradient(90deg, 
          #10b981 0%, 
          #06b6d4 15%, 
          #0ea5e9 35%, 
          #3b82f6 50%, 
          #0ea5e9 65%, 
          #06b6d4 85%, 
          #10b981 100%);
        background-size: 200% 100%;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        animation: brandOverlay 6s ease infinite;
      }
      .loader-brand::after {
        content: 'ObelixIA';
        position: absolute;
        inset: 0;
        background: linear-gradient(110deg, transparent 0%, transparent 40%, rgba(255,255,255,0.9) 45%, rgba(255,255,255,0.9) 55%, transparent 60%, transparent 100%);
        background-size: 300% 100%;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        animation: shineSwoop 4s ease-in-out infinite;
      }
      @keyframes brandGradientFlow {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
      }
      @keyframes brandOverlay {
        0%, 45% { opacity: 0; }
        50% { opacity: 0.5; }
        55%, 100% { opacity: 0; }
      }
      @keyframes shineSwoop {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
      }
      
      /* Theme variations */
      .theme-day .initial-loader {
        background: radial-gradient(ellipse at center, #e0f2fe 0%, #f0f9ff 50%, #ffffff 100%);
      }
      .theme-day .infinity-glow-outer {
        background: radial-gradient(ellipse, rgba(6,182,212,0.2) 0%, rgba(16,185,129,0.1) 40%, transparent 70%);
      }
      .theme-creand .initial-loader {
        background: radial-gradient(ellipse at center, #ecfdf5 0%, #f0fdf4 50%, #ffffff 100%);
      }
      .theme-aurora .initial-loader {
        background: radial-gradient(ellipse at center, #1e1b4b 0%, #0f0a26 50%, #000 100%);
      }
    </style>

    <!-- Open Graph -->
    <meta property="og:title" content="ObelixIA - CRM Bancario Inteligente" />
    <meta property="og:description" content="Plataforma CRM bancaria con IA para gestión comercial y análisis financiero" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@ObelixIA" />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
    
    <!-- Professional Typography with font-display: swap for CLS prevention -->
    <link 
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" 
      rel="stylesheet"
      media="print"
      onload="this.media='all'"
      crossorigin="anonymous"
    >
    <noscript>
      <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet" crossorigin="anonymous">
    </noscript>
    
    <!-- Theme initialization to prevent flash (FOUC prevention) -->
    <script>
      (function() {
        try {
          var savedTheme = localStorage.getItem('app-theme') || 'day';
          document.documentElement.className = 'theme-' + savedTheme;
        } catch(e) {}
      })();
    </script>
    
    <!-- Preload critical resources for LCP -->
    <link rel="preload" href="/src/main.tsx" as="script" crossorigin>
    
    <!-- Service Worker Registration -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register('/sw.js', { scope: '/' })
            .then(function(registration) {
              console.log('[App] ServiceWorker registered:', registration.scope);
            })
            .catch(function(error) {
              console.log('[App] ServiceWorker registration failed:', error);
            });
        });
      }
    </script>
  </head>

  <body>
    <!-- Hollywood Cinematic Loader -->
    <div id="initial-loader" class="initial-loader">
      <!-- Star field background -->
      <div class="star-field">
        <div class="star" style="width:2px;height:2px;left:5%;top:10%;animation-delay:0s"></div>
        <div class="star" style="width:3px;height:3px;left:15%;top:25%;animation-delay:0.3s"></div>
        <div class="star" style="width:2px;height:2px;left:25%;top:8%;animation-delay:0.7s"></div>
        <div class="star" style="width:2px;height:2px;left:35%;top:15%;animation-delay:1.1s"></div>
        <div class="star" style="width:3px;height:3px;left:45%;top:5%;animation-delay:0.2s"></div>
        <div class="star" style="width:2px;height:2px;left:55%;top:20%;animation-delay:0.9s"></div>
        <div class="star" style="width:2px;height:2px;left:65%;top:12%;animation-delay:1.4s"></div>
        <div class="star" style="width:3px;height:3px;left:75%;top:8%;animation-delay:0.5s"></div>
        <div class="star" style="width:2px;height:2px;left:85%;top:18%;animation-delay:1.2s"></div>
        <div class="star" style="width:2px;height:2px;left:92%;top:10%;animation-delay:0.8s"></div>
        <div class="star" style="width:2px;height:2px;left:8%;top:85%;animation-delay:1.6s"></div>
        <div class="star" style="width:3px;height:3px;left:20%;top:78%;animation-delay:0.4s"></div>
        <div class="star" style="width:2px;height:2px;left:30%;top:90%;animation-delay:1.0s"></div>
        <div class="star" style="width:2px;height:2px;left:70%;top:82%;animation-delay:1.3s"></div>
        <div class="star" style="width:3px;height:3px;left:80%;top:88%;animation-delay:0.6s"></div>
        <div class="star" style="width:2px;height:2px;left:95%;top:75%;animation-delay:1.5s"></div>
      </div>
      
      <!-- Hollywood Rainbow Arc (Blue-Green gradient) -->
      <div class="hollywood-arc"></div>
      
      <!-- Explosion particles that fly to ALL screen -->
      <div class="explosion-particles" id="explosion-container"></div>
      
      <!-- Brand name with dual gradient - appears first in center -->
      <div class="brand-container">
        <div class="loader-brand">ObelixIA</div>
      </div>
      
      <!-- Greek-style Infinity Symbol - rolls from top-left to below text -->
      <div class="infinity-container">
        <div class="infinity-glow-outer"></div>
        <svg class="infinity-svg" viewBox="0 0 200 100">
          <defs>
            <!-- Main gradient -->
            <linearGradient id="infinityGrad" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#0ea5e9">
                <animate attributeName="stop-color" values="#0ea5e9;#10b981;#06b6d4;#0ea5e9" dur="5s" repeatCount="indefinite" />
              </stop>
              <stop offset="50%" stop-color="#10b981">
                <animate attributeName="stop-color" values="#10b981;#06b6d4;#0ea5e9;#10b981" dur="5s" repeatCount="indefinite" />
              </stop>
              <stop offset="100%" stop-color="#06b6d4">
                <animate attributeName="stop-color" values="#06b6d4;#0ea5e9;#10b981;#06b6d4" dur="5s" repeatCount="indefinite" />
              </stop>
            </linearGradient>
            
            <!-- Glow filter -->
            <filter id="infinityGlow" x="-100%" y="-100%" width="300%" height="300%">
              <feGaussianBlur stdDeviation="4" result="blur1"/>
              <feGaussianBlur stdDeviation="8" result="blur2"/>
              <feMerge>
                <feMergeNode in="blur2"/>
                <feMergeNode in="blur1"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
            
            <!-- Sparkle filter for particles -->
            <filter id="sparkleGlow" x="-200%" y="-200%" width="500%" height="500%">
              <feGaussianBlur stdDeviation="3" result="blur"/>
              <feMerge>
                <feMergeNode in="blur"/>
                <feMergeNode in="blur"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
          </defs>
          
          <!-- Classic Lemniscate (∞) - Greek infinity symbol -->
          <path id="infinityPath" 
            d="M100,50 C100,30 120,15 145,15 C175,15 190,35 190,50 C190,65 175,85 145,85 C120,85 100,70 100,50 C100,30 80,15 55,15 C25,15 10,35 10,50 C10,65 25,85 55,85 C80,85 100,70 100,50" 
            fill="none" 
            stroke="url(#infinityGrad)" 
            stroke-width="6" 
            stroke-linecap="round"
            stroke-linejoin="round"
            filter="url(#infinityGlow)"
          />
          
          <!-- Flowing energy along path -->
          <path 
            d="M100,50 C100,30 120,15 145,15 C175,15 190,35 190,50 C190,65 175,85 145,85 C120,85 100,70 100,50 C100,30 80,15 55,15 C25,15 10,35 10,50 C10,65 25,85 55,85 C80,85 100,70 100,50" 
            fill="none" 
            stroke="white" 
            stroke-width="3" 
            stroke-linecap="round"
            stroke-dasharray="15 385"
            filter="url(#sparkleGlow)"
            opacity="0.8"
          >
            <animate attributeName="stroke-dashoffset" values="0;-400" dur="2s" repeatCount="indefinite"/>
          </path>
          
          <!-- Synchrotron particles circulating along infinity path -->
          <g id="infinityParticles" filter="url(#sparkleGlow)">
            <!-- 8 particles evenly distributed (JS animates along the path for maximum compatibility) -->
            <circle class="infinity-particle" data-phase="0" cx="100" cy="50" r="4" fill="white" opacity="0.95" style="animation-delay:0s" />
            <circle class="infinity-particle" data-phase="0.125" cx="100" cy="50" r="4" fill="white" opacity="0.95" style="animation-delay:0.1s" />
            <circle class="infinity-particle" data-phase="0.25" cx="100" cy="50" r="4" fill="white" opacity="0.95" style="animation-delay:0.2s" />
            <circle class="infinity-particle" data-phase="0.375" cx="100" cy="50" r="4" fill="white" opacity="0.95" style="animation-delay:0.3s" />
            <circle class="infinity-particle" data-phase="0.5" cx="100" cy="50" r="4" fill="white" opacity="0.95" style="animation-delay:0.4s" />
            <circle class="infinity-particle" data-phase="0.625" cx="100" cy="50" r="4" fill="white" opacity="0.95" style="animation-delay:0.5s" />
            <circle class="infinity-particle" data-phase="0.75" cx="100" cy="50" r="4" fill="white" opacity="0.95" style="animation-delay:0.6s" />
            <circle class="infinity-particle" data-phase="0.875" cx="100" cy="50" r="4" fill="white" opacity="0.95" style="animation-delay:0.7s" />
          </g>
        </svg>
      </div>
    </div>
    
    <!-- Script for explosion particles -->
    <script>
      (function() {
        var container = document.getElementById('explosion-container');
        if (!container) return;
        
        var centerX = window.innerWidth / 2;
        var centerY = window.innerHeight / 2 - 60;
        var colors = ['#0ea5e9', '#06b6d4', '#10b981', '#34d399', '#ffffff'];
        
        function createExplosion() {
          for (var i = 0; i < 8; i++) {
            setTimeout(function() {
              var particle = document.createElement('div');
              particle.className = 'explosion-particle';
              
              var angle = Math.random() * Math.PI * 2;
              var distance = 300 + Math.random() * 500;
              var destX = Math.cos(angle) * distance;
              var destY = Math.sin(angle) * distance;
              var size = 2 + Math.random() * 4;
              var color = colors[Math.floor(Math.random() * colors.length)];
              var duration = 2 + Math.random() * 2;
              
              particle.style.cssText = 
                'width:' + size + 'px;' +
                'height:' + size + 'px;' +
                'color:' + color + ';' +
                'background:' + color + ';' +
                'animation: particleExplode ' + duration + 's ease-out forwards;' +
                '--destX:' + destX + 'px;' +
                '--destY:' + destY + 'px;';
              
              container.appendChild(particle);
              
              setTimeout(function() { particle.remove(); }, duration * 1000);
            }, i * 80);
          }
        }
        
        // Add the keyframe animation
        var style = document.createElement('style');
        style.textContent = '@keyframes particleExplode { 0% { transform: translate(-50%, -50%) scale(0); opacity: 1; } 20% { transform: translate(-50%, -50%) scale(1.5); opacity: 1; } 100% { transform: translate(calc(-50% + var(--destX)), calc(-50% + var(--destY))) scale(0.3); opacity: 0; } }';
        document.head.appendChild(style);
        
        // Start explosions
        setInterval(createExplosion, 600);
        createExplosion();
      })();
    </script>

    <!-- Script for infinity particles motion - starts immediately with retry -->
    <script>
      (function () {
        var started = false;
        function initInfinityParticles() {
          if (started) return;
          var svg = document.querySelector('.infinity-svg');
          if (!svg) return setTimeout(initInfinityParticles, 10);

          var path = svg.querySelector('#infinityPath');
          var group = svg.querySelector('#infinityParticles');
          if (!path || !group || typeof path.getTotalLength !== 'function') {
            return setTimeout(initInfinityParticles, 10);
          }

          var circles = Array.prototype.slice.call(group.querySelectorAll('circle[data-phase]'));
          if (!circles.length) return;

          started = true;
          var len = path.getTotalLength();
          var secondsPerLap = 3;
          var speed = len / secondsPerLap;

          function frame(now) {
            var t = now / 1000;
            for (var i = 0; i < circles.length; i++) {
              var c = circles[i];
              var phase = parseFloat(c.getAttribute('data-phase') || '0') || 0;
              var dist = (t * speed + phase * len) % len;
              var p = path.getPointAtLength(dist);
              c.setAttribute('cx', p.x);
              c.setAttribute('cy', p.y);
            }
            requestAnimationFrame(frame);
          }

          requestAnimationFrame(frame);
        }

        // Run immediately and keep retrying until SVG is ready
        initInfinityParticles();
      })();
    </script>

    <!-- Plausible Analytics - Privacy-friendly -->
    <script defer data-domain="obelixia.app" src="https://plausible.io/js/script.js"></script>
    
    <div id="root"></div>
    
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- Hide loader when app is ready - optimized timing -->
    <script>
      window.addEventListener('DOMContentLoaded', function() {
        var loader = document.getElementById('initial-loader');
        if (loader) {
          // Reduced loader time for better perceived performance (3.2s -> 2s)
          setTimeout(function() {
            loader.classList.add('hidden');
            setTimeout(function() { loader.remove(); }, 500);
          }, 2000);
        }
      });
    </script>
  </body>
</html>
